(this["webpackJsonpecommerce-client"]=this["webpackJsonpecommerce-client"]||[]).push([[0],{102:function(e,t,n){},111:function(e,t,n){},133:function(e,t,n){"use strict";n.r(t);var r,a,s,c,i,o,d,u,l,h,j,m,b,g,p,O,f,x,w,v,y,C=n(0),S=n.n(C),P=n(33),k=n.n(P),I=(n(102),n(97)),N=n(7),A=n(8),F=n(9),T=n(36),E=n(85),L=n(13),U=n(141),D=n(2),B=n(3),_=n(1),z=["user","component","render"],H=function(e){var t=e.user,n=e.component,r=e.render,a=Object(B.a)(e,z);return t&&r?Object(_.jsx)(L.b,Object(D.a)(Object(D.a)({},a),{},{render:r})):Object(_.jsx)(L.b,Object(D.a)(Object(D.a)({},a),{},{render:function(e){return t?Object(_.jsx)(n,Object(D.a)({},e)):Object(_.jsx)(L.a,{to:"/"})}}))},q=n(28),G=n(29),M=n(32),$=n(31),K=n(72),R=(n(111),function(e){Object(M.a)(n,e);var t=Object($.a)(n);function n(e){var r;return Object(q.a)(this,n),(r=t.call(this,e)).handleClose=function(){return r.setState({show:!1})},r.state={show:!0},r.timeoutId=null,r}return Object(G.a)(n,[{key:"componentDidMount",value:function(){this.timeoutId=setTimeout(this.handleClose,5e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this.props,t=e.variant,n=e.heading,r=e.message,a=e.deleteAlert,s=e.id;return this.state.show||setTimeout((function(){a(s)}),300),Object(_.jsx)(K.a,{dismissible:!0,show:this.state.show,variant:t,onClose:this.handleClose,children:Object(_.jsxs)("div",{className:"container",children:[Object(_.jsx)(K.a.Heading,{children:n}),Object(_.jsx)("p",{className:"alert-body",children:r})]})})}}]),n}(S.a.Component)),W=n(34),Q=n(48),X=n(14),J=n(45),Y=n(139),V=n(140),Z=function(){var e="1.4em",t=Object(C.useState)(!1),n=Object(N.a)(t,2),r=n[0],a=n[1];return Object(_.jsxs)("div",{style:{width:"1.5em"},onMouseOver:function(){return a(!0)},onMouseOut:function(){return a(!1)},children:[Object(_.jsx)(J.a,{className:"position-absolute",timeout:800,in:!r,children:Object(_.jsx)(Y.a,{size:e})}),Object(_.jsx)(J.a,{className:"position-absolute",in:r,children:Object(_.jsx)(V.a,{size:e})})]})},ee=Object(_.jsxs)(C.Fragment,{children:[Object(_.jsx)(X.c,{to:"/cart",className:"nav-link cart-hover",style:{minHeight:"2.5em"},children:Object(_.jsx)(Z,{})}),Object(_.jsx)(X.c,{to:"/account",className:"nav-link",children:"Account"})]}),te=Object(_.jsxs)(C.Fragment,{children:[Object(_.jsx)(X.c,{to:"/sign-up",className:"nav-link",children:"Sign Up"}),Object(_.jsx)(X.c,{to:"/sign-in",className:"nav-link",children:"Sign In"})]}),ne=Object(_.jsx)(C.Fragment,{}),re=function(e){var t=e.user;return Object(_.jsxs)(Q.a,{style:{padding:"0.5em 1em"},bg:"primary",variant:"dark",expand:"md",children:[Object(_.jsx)(Q.a.Brand,{children:Object(_.jsx)(X.b,{to:"/",className:"brand",children:"Buy Things"})}),Object(_.jsx)(Q.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(_.jsx)(Q.a.Collapse,{id:"basic-navbar-nav",children:Object(_.jsxs)(W.a,{className:"ms-auto w-100 justify-content-end",children:[t&&Object(_.jsxs)("span",{className:"navbar-text me-auto",children:["Welcome, ",t.email]}),ne,t?ee:te]})})]})},ae=n(11),se="https://buy-things-api.herokuapp.com",ce="http://localhost:4741",ie="localhost"===window.location.hostname?ce:se,oe=n(19),de=n.n(oe),ue=function(e){return de()({url:ie+"/auth/sign-in/",method:"POST",data:{credentials:{email:e.email,password:e.password}}})},le=n(10),he=n(40),je=n(70),me="#1f3164",be="#FF6A3D",ge="#F4DB7D",pe="rgba(0, 0, 0, 0.125)",Oe={primary:me,secondary:be,accent:ge,light:pe},fe=Object(F.a)(je.a)(r||(r=Object(A.a)(["\n  background: ",";\n  border: 1px solid ",";\n  color: white;\n  margin-top: 1em;\n\n  &:hover, &:focus {\n    color: ","};\n  }\n"])),me,pe,ge),xe=Object(F.a)(je.a)(a||(a=Object(A.a)(["\n  background: ",";\n  border: 1px solid ",";\n  color: white;\n  margin: 0 auto;\n  width: 60%;\n\n  &:hover, &:focus {\n    background: ",";\n    color: white;\n  }\n"])),be,pe,Object(he.a)(.2,be)),we=fe,ve=function(e){Object(M.a)(n,e);var t=Object($.a)(n);function n(e){var r;return Object(q.a)(this,n),(r=t.call(this,e)).handleChange=function(e){return r.setState(Object(ae.a)({},e.target.name,e.target.value))},r.onSignUp=function(e){e.preventDefault();var t,n=r.props,a=n.msgAlert,s=n.history,c=n.setUser;(t=r.state,de()({method:"POST",url:ie+"/auth/sign-up/",data:{credentials:{email:t.email,password:t.password,password_confirmation:t.passwordConfirmation}}})).then((function(){return ue(r.state)})).then((function(e){return c(e.data.user)})).then((function(){return a({heading:"Sign Up Success",message:"Succesfully registered! You've been signed in as well.",variant:"success"})})).then((function(){return s.push("/")})).catch((function(e){r.setState({email:"",password:"",passwordConfirmation:""}),a({heading:"Sign Up Failed with error: "+e.message,message:"Registration failed. Email may be taken, or passwords don't match.",variant:"danger"})}))},r.state={email:"",password:"",passwordConfirmation:""},r}return Object(G.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,r=e.passwordConfirmation;return Object(_.jsx)("div",{className:"row",children:Object(_.jsxs)("div",{className:"col-sm-10 col-md-8 mx-auto mt-5",children:[Object(_.jsx)("h3",{children:"Sign Up"}),Object(_.jsxs)(le.a,{onSubmit:this.onSignUp,children:[Object(_.jsxs)(le.a.Group,{controlId:"email",children:[Object(_.jsx)(le.a.Label,{children:"Email address"}),Object(_.jsx)(le.a.Control,{required:!0,type:"email",name:"email",value:t,placeholder:"Enter email",onChange:this.handleChange})]}),Object(_.jsxs)(le.a.Group,{controlId:"password",children:[Object(_.jsx)(le.a.Label,{children:"Password"}),Object(_.jsx)(le.a.Control,{required:!0,name:"password",value:n,type:"password",placeholder:"Password",onChange:this.handleChange})]}),Object(_.jsxs)(le.a.Group,{controlId:"passwordConfirmation",children:[Object(_.jsx)(le.a.Label,{children:"Password Confirmation"}),Object(_.jsx)(le.a.Control,{required:!0,name:"passwordConfirmation",value:r,type:"password",placeholder:"Confirm Password",onChange:this.handleChange})]}),Object(_.jsx)(we,{variant:"primary",type:"submit",children:"Submit"})]})]})})}}]),n}(C.Component),ye=Object(L.f)(ve),Ce=function(e){Object(M.a)(n,e);var t=Object($.a)(n);function n(e){var r;return Object(q.a)(this,n),(r=t.call(this,e)).handleChange=function(e){return r.setState(Object(ae.a)({},e.target.name,e.target.value))},r.onSignIn=function(e){e.preventDefault();var t=r.props,n=t.msgAlert,a=t.history,s=t.setUser;ue(r.state).then((function(e){return s(e.data.user)})).then((function(){return n({heading:"Sign In Success",message:"Welcome!",variant:"success"})})).then((function(){return a.push("/")})).catch((function(e){r.setState({email:"",password:""}),n({heading:"Sign In Failed with error: "+e.message,message:"Failed to sign in. Check your email and password and try again.",variant:"danger"})}))},r.state={email:"",password:""},r}return Object(G.a)(n,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password;return Object(_.jsx)("div",{className:"row",children:Object(_.jsxs)("div",{className:"col-sm-10 col-md-8 mx-auto mt-5",children:[Object(_.jsx)("h3",{children:"Sign In"}),Object(_.jsxs)(le.a,{onSubmit:this.onSignIn,children:[Object(_.jsxs)(le.a.Group,{controlId:"email",children:[Object(_.jsx)(le.a.Label,{children:"Email address"}),Object(_.jsx)(le.a.Control,{required:!0,type:"email",name:"email",value:t,placeholder:"Enter email",onChange:this.handleChange})]}),Object(_.jsxs)(le.a.Group,{controlId:"password",children:[Object(_.jsx)(le.a.Label,{children:"Password"}),Object(_.jsx)(le.a.Control,{required:!0,name:"password",value:n,type:"password",placeholder:"Password",onChange:this.handleChange})]}),Object(_.jsx)(we,{variant:"primary",type:"submit",children:"Submit"})]})]})})}}]),n}(C.Component),Se=Object(L.f)(Ce),Pe=function(e){Object(M.a)(n,e);var t=Object($.a)(n);function n(){return Object(q.a)(this,n),t.apply(this,arguments)}return Object(G.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.msgAlert,n=e.history,r=e.clearUser;(function(e){return de()({url:ie+"/auth/sign-out/",method:"DELETE",headers:{Authorization:"Bearer ".concat(e.token)}})})(e.user).finally((function(){return t({heading:"Signed Out Successfully",message:"Come back soon!",variant:"success"})})).finally((function(){return n.push("/")})).finally((function(){return r()}))}},{key:"render",value:function(){return""}}]),n}(C.Component),ke=Object(L.f)(Pe),Ie=Object(F.a)(X.b)(s||(s=Object(A.a)(["\n  color: ",";\n  &:hover, &:focus {\n    color: ",";\n    font-weight: 600;\n  }\n"])),me,Object(he.b)(.2,me)),Ne=function(e,t){return de()({url:ie+"/orders/"+e+"/checkout",method:"patch",data:{},headers:{Authorization:"Bearer ".concat(t.token)}})},Ae=function(e){var t=e.msgAlert,n=e.user,r=Object(C.useState)(null),a=Object(N.a)(r,2),s=a[0],c=a[1];return Object(C.useEffect)((function(){(function(e){var t=ie+"/orders";return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(t+="?completed=true"),de()({url:t,headers:{Authorization:"Bearer ".concat(e.token)}})})(n,!0).then((function(e){return c(e.data.orders)})).then((function(){return t({heading:"Order History Success",message:"All completed orders displayed",variant:"success"})})).catch((function(e){return t({heading:"Order History Failure",message:"Something went wrong: "+e.message,variant:"danger"})}))}),[]),null===s?"Loading...":0===s.length?"No orders to display - get shopping!":Object(_.jsx)("ul",{children:s.map((function(e){return Object(_.jsxs)("li",{children:[e.products.reduce((function(e,t){return e+t.count}),0)," items - $",e.totalPrice]},e._id)}))})},Fe=n(47),Te=n(92),Ee=n(46),Le=function(e){var t=e.msgAlert,n=e.history,r=e.user,a=Object(C.useState)({oldPassword:"",newPassword:""}),s=Object(N.a)(a,2),c=s[0],i=s[1],o=function(e){return i(Object(ae.a)({},e.target.name,e.target.value))};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("h5",{children:"Change Password"}),Object(_.jsxs)(le.a,{onSubmit:function(e){e.preventDefault(),function(e,t){return de()({url:ie+"/auth/change-password/",method:"PATCH",headers:{Authorization:"Bearer ".concat(t.token)},data:{passwords:{old:e.oldPassword,new:e.newPassword}}})}(c,r).then((function(){return t({heading:"Change Password Success",message:"Password changed successfully!",variant:"success"})})).then((function(){return n.push("/")})).catch((function(e){i({oldPassword:"",newPassword:""}),t({heading:"Change Password Failed with error: "+e.message,message:"Failed to change passwords. Check your old password and try again.",variant:"danger"})}))},children:[Object(_.jsxs)(le.a.Group,{controlId:"oldPassword",children:[Object(_.jsx)(le.a.Label,{children:"Old password"}),Object(_.jsx)(le.a.Control,{required:!0,name:"oldPassword",value:c.oldPassword,type:"password",placeholder:"Old Password",onChange:o})]}),Object(_.jsxs)(le.a.Group,{controlId:"newPassword",children:[Object(_.jsx)(le.a.Label,{children:"New Password"}),Object(_.jsx)(le.a.Control,{required:!0,name:"newPassword",value:c.newPassword,type:"password",placeholder:"New Password",onChange:o})]}),Object(_.jsx)(we,{variant:"primary",type:"submit",children:"Submit"})]})]})},Ue=Object(F.a)(W.a.Link)(c||(c=Object(A.a)(["\n  margin: 0.25em 0;\n\n  &:hover, &:focus {\n    background: ",";\n    cursor: pointer;\n  }\n"])),Object(he.b)(.7,me)),De=F.a.div(i||(i=Object(A.a)(["\n  margin: 0 auto;\n\n  @media (min-width: 768px) {\n    width: 80%;\n  }\n"]))),Be=Object(L.f)((function(e){return Object(_.jsx)(De,{children:Object(_.jsx)(Fe.a.Container,{className:"border-soft",defaultActiveKey:"settings",children:Object(_.jsxs)(Te.a,{children:[Object(_.jsx)(Ee.a,{className:"mt-5",sm:3,style:{borderRight:"1px solid ".concat(pe)},children:Object(_.jsxs)(W.a,{variant:"pills",className:"flex-column",children:[Object(_.jsx)(W.a.Item,{children:Object(_.jsx)(Ue,{eventKey:"settings",children:"Account Setting"})}),Object(_.jsx)(W.a.Item,{children:Object(_.jsx)(Ue,{eventKey:"orderHistory",children:"Order History"})}),Object(_.jsx)(W.a.Item,{className:"text-center mt-2",children:Object(_.jsx)(Ie,{to:"/sign-out",children:"Sign Out"})})]})}),Object(_.jsx)(Ee.a,{className:"mt-5",sm:9,children:Object(_.jsxs)(Fe.a.Content,{children:[Object(_.jsx)(Fe.a.Pane,{eventKey:"settings",children:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("h4",{children:"Update your data:"}),Object(_.jsx)("hr",{}),Object(_.jsx)(Le,{})]})}),Object(_.jsx)(Fe.a.Pane,{eventKey:"orderHistory",children:Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("h4",{children:"Order history:"}),Object(_.jsx)(Ae,Object(D.a)({},e))]})})]})})]})})})})),_e=n(71),ze=n.n(_e),He=n(93),qe=n(94),Ge=n(61),Me=n(54),$e=Object(F.a)(le.a)(o||(o=Object(A.a)(["\n  display: flex;\n  max-width: 80%;\n"]))),Ke=Object(F.a)(Me.a)(d||(d=Object(A.a)(["\n  max-width: 6em;\n  display: inline;\n"]))),Re=F.a.button(u||(u=Object(A.a)(["\n  border: 0;\n  background: transparent;\n  text-decoration: underline;\n\n  &:hover, &:focus {\n    font-weight: 800;\n  }\n"]))),We=function(e){var t=e.prodId,n=e.count,r=e.updateProductInCart,a=Object(C.useState)(0),s=Object(N.a)(a,2),c=s[0],i=s[1];return Object(C.useEffect)((function(){c&&i(0)}),[n]),Object(_.jsxs)($e,{onSubmit:function(e){e.preventDefault(),r(t,c||n)},children:[Object(_.jsx)(Ke,{onChange:function(e){return i(e.target.value)},type:"number",size:"sm",value:c||n}),Object(_.jsx)(Re,{type:"submit",children:"Update"})]})},Qe=F.a.div(l||(l=Object(A.a)(["\n  width: 100%;\n\n  @media (min-width: 768px) {\n    min-width: 40%;\n  }\n"]))),Xe=Object(F.a)(Ie)(h||(h=Object(A.a)(["\n  display: block;\n  font-size: 0.75em;\n  margin-top: 0.5em;\n"]))),Je=function(e){var t=e.total,n=e.products,r=e.removeFromCart,a=e.updateProductInCart;return Object(_.jsxs)(Qe,{className:"p-2",children:[Object(_.jsx)("h2",{children:"Current Cart:"}),Object(_.jsxs)(Ge.a,{children:[n.map((function(e,t){var n=e.productRef,s=e.count;return Object(_.jsxs)(Ge.a.Item,{variant:"info",children:[Object(_.jsxs)("span",{children:[n.title," - $",n.price," each"]}),Object(_.jsx)(We,{prodId:n._id,count:s,updateProductInCart:a}),Object(_.jsxs)("span",{className:"order-price",children:["$",(parseFloat(n.price)*s).toFixed(2)]}),Object(_.jsx)(Xe,{onClick:function(){return r(n._id)},children:"Remove from cart"})]},t)})),Object(_.jsxs)(Ge.a.Item,{className:"order-price",style:{fontWeight:"bold"},variant:"warning",children:["Total: $",t]})]})]})},Ye=F.a.div(j||(j=Object(A.a)(["\n  align-items: center;\n  border: 1px solid ",";\n  border-radius: 0.25em;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n"])),Oe.light),Ve=Object(F.a)(Ye)(m||(m=Object(A.a)(["\n  background-color: ","\n"])),(function(e){return Oe[e.variant]})),Ze=Object(F.a)(le.a)(b||(b=Object(A.a)(["\n  align-items: stretch;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  min-height: 100%;\n  position: relative;\n  width: 100%;\n"]))),et=Object(F.a)(we)(g||(g=Object(A.a)(["\n  // width: 100%;\n"]))),tt=Object(F.a)(Ve)(p||(p=Object(A.a)(["\n  width: 100%;\n\n  @media (max-width: 768px) {\n    min-width: 40%;\n  }\n"]))),nt=F.a.div(O||(O=Object(A.a)(["\n  align-items: flex-end;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  justify-content: center;\n\n  @media (min-width: 768px) {\n    flex-wrap: nowrap;\n  }\n"]))),rt=Object(L.f)((function(e){var t=e.order,n=e.user,r=e.msgAlert,a=e.completeOrder,s=e.history,c=e.removeFromCart,i=e.updateProductInCart,o=Object(C.useState)(null),d=Object(N.a)(o,2),u=d[0],l=d[1],h=Object(C.useState)(0),j=Object(N.a)(h,2),m=j[0],b=j[1],g=Object(T.useStripe)(),p=Object(T.useElements)();Object(C.useEffect)((function(){t.products.length>0&&function(e,t){return de()({url:ie+"/stripe/payment-intent/"+e,method:"post",headers:{Authorization:"Bearer ".concat(t.token)}})}(t._id,n).then((function(e){l(e.data.clientSecret),b(e.data.totalPrice)})).catch((function(e){return r({heading:"Payment intent failed",message:"Something went wrong: "+e.message,variant:"danger"})}))}),[t]);var O=function(e){r({heading:"Payment Error",message:"Something went wrong: "+e.message,variant:"danger"})},f=function(){var e=Object(He.a)(ze.a.mark((function e(c){var i;return ze.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),g&&p||r({heading:"Stripe not loaded",message:"Try again in a few seconds",variant:"info"}),e.next=4,g.confirmCardPayment(u,{payment_method:{card:p.getElement(T.CardElement)}});case 4:(i=e.sent).error?O(i.error):Ne(t._id,n).then((function(e){a(),s.push("/"),r({heading:"Payment success",message:"Thanks for the money ;) Buy more things now",variant:"success"})})).catch(O);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsx)(_.Fragment,{children:Object(_.jsx)(nt,{children:t&&Object(_.jsx)(_.Fragment,{children:t.products.length>0?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(Je,{products:t.products,total:m,removeFromCart:c,updateProductInCart:i}),Object(_.jsx)(tt,{variant:"accent",className:"m-2 p-3",children:u?Object(_.jsxs)(Ze,{onSubmit:f,children:[Object(_.jsx)(T.CardElement,{}),Object(_.jsxs)(le.a.Text,{className:"text-muted my-2",children:["This is a dummy application. Do not enter real information.",Object(_.jsx)("br",{})," Use test card number ",Object(_.jsx)("code",{children:"4242 4242 4242 4242"}),", any future expiration date, and any numbers for CVC and postal code."]}),Object(_.jsx)(et,{type:"submit",children:"Checkout"})]}):Object(_.jsx)(qe.a,{animation:"border",role:"status",children:Object(_.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]}):"No items in cart - get to shopping!"})})})})),at=n(49),st=Object(F.a)(at.a)(f||(f=Object(A.a)(["\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 1em;\n  padding: 1em 0.5em;\n  text-align: center;\n\n  width: 49%;\n\n  &:nth-child(1) {\n    margin-left: 0;\n  }\n\n  &:nth-child(4n) {\n    margin-right: 0;\n  }\n\n  @media (min-width: 768px) {\n    width: 24%;\n  }\n"]))),ct=function(e){var t=e.id,n=e.title,r=e.price,a=e.image,s=e.addToCart;return Object(_.jsxs)(st,{children:[Object(_.jsxs)(X.b,{to:"/details/".concat(t),className:"d-flex",style:{flexDirection:"column",flexGrow:1,justifyContent:"space-between"},children:[Object(_.jsx)("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(_.jsx)(at.a.Img,{variant:"top",src:a||"https://res.cloudinary.com/esalling/image/upload/v1630877341/BuyThings/noimage.jpg"})}),Object(_.jsx)(at.a.Title,{style:{marginTop:"0.5em"},children:n})]}),Object(_.jsxs)(at.a.Text,{children:["$",r]}),Object(_.jsx)(xe,{onClick:function(){return s(t,1)},children:"Add to cart"})]})},it=F.a.div(x||(x=Object(A.a)(['\n  align-items: stretch;\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: space-between;\n  margin: 2rem auto;\n  width: 80%;\n\n  &:after {\n    content: "";\n    flex-basis: ',"%;\n    flex-grow: 0;\n  }\n"])),(function(e){return 24*(4-e.listLen%4)})),ot=function(e){var t=e.addToCart,n=e.msgAlert,r=Object(C.useState)(null),a=Object(N.a)(r,2),s=a[0],c=a[1];return Object(C.useEffect)((function(){de()({url:ie+"/products"}).then((function(e){return c(e.data.products)})).then((function(){return n({heading:"Index Products Success",message:"Check em out",variant:"success"})})).catch((function(e){return n({heading:"Index Products Failure",message:"Something went wrong: "+e.message,variant:"danger"})}))}),[]),Object(_.jsx)(_.Fragment,{children:s?0===s.length?Object(_.jsx)("p",{className:"text-center",children:"Sorry... looks like we're out of stock of everything."}):Object(_.jsx)(it,{listLen:s?s.length:0,children:s.map((function(e){return Object(_.jsx)(ct,{id:e._id,title:e.title,price:e.price,image:e.image,addToCart:t},e._id)}))}):Object(_.jsx)("p",{className:"text-center",children:"Loading..."})})},dt=n(95),ut=F.a.div(w||(w=Object(A.a)(["\n  display: flex;\n  flex-wrap: wrap-reverse;\n  flex-direction: row;\n  flex-grow: 0;\n  justify-content: center;\n  margin: 2em;\n\n  @media (min-width: 768px) {\n    flex-wrap: nowrap;\n  }\n"]))),lt=F.a.div(v||(v=Object(A.a)(["\n  flex: auto;\n  margin: 1rem;\n  width: 100%;\n\n  @media (min-width: 768px) {\n    width: 40%;\n  }\n"]))),ht=Object(L.f)((function(e){var t=e.match,n=e.msgAlert,r=e.addToCart,a=Object(C.useState)(null),s=Object(N.a)(a,2),c=s[0],i=s[1];return Object(C.useEffect)((function(){var e;(e=t.params.id,de()({url:ie+"/products/"+e})).then((function(e){return i(e.data.product)})).then((function(){return n({heading:"Show Product Success!",message:"Check out the product details on this page.",variant:"success"})})).catch((function(e){return n({heading:"Show Product Failed",message:"Something went wrong: "+e.message,variant:"danger"})}))}),[]),null===c?"Loading...":Object(_.jsxs)(ut,{children:[Object(_.jsxs)(lt,{children:[Object(_.jsx)(dt.a,{fluid:!0,className:"w-100",src:"https://res.cloudinary.com/esalling/image/upload/v1518704988/few_dots.jpg"}),Object(_.jsx)("p",{className:"py-4",children:c.description})]}),Object(_.jsxs)(lt,{children:[Object(_.jsx)("h3",{className:"text-display",children:c.title}),Object(_.jsxs)("h4",{children:["Price: $",c.price]}),Object(_.jsx)(xe,{onClick:function(){return r(t.params.id)},children:"Add to cart"})]})]})})),jt=n(96),mt=Object(E.a)("pk_test_51HtHLTIILRHGeAn02ibfcqyDtGe4EAD0Qubsd3jPzOrIg5fnYSwaMDNDHaDsUx3XQZUgbq67UhLraMjpOQIWXfex0064HXxmqF"),bt=Object(F.a)(jt.a)(y||(y=Object(A.a)(["\n  margin-top: 2rem;\n"]))),gt=Object(L.f)((function(e){var t=e.history,n=Object(C.useState)(null),r=Object(N.a)(n,2),a=r[0],s=r[1],c=Object(C.useState)([]),i=Object(N.a)(c,2),o=i[0],d=i[1],u=Object(C.useState)(null),l=Object(N.a)(u,2),h=l[0],j=l[1];Object(C.useEffect)((function(){a&&v()}),[a]);var m=function(e){return s(e)},b=function(){return s(null)},g=function(e){d((function(t){return t.filter((function(t){return t.id!==e}))}))},p=function(e){var t=e.heading,n=e.message,r=e.variant,a=Object(U.a)();d((function(e){return[].concat(Object(I.a)(e),[{heading:t,message:n,variant:r,id:a}])}))},O=function(e,n){if(!h||!a)return t.push("/sign-in"),void p({heading:"Please sign in",message:"Login or create an account to start shopping",variant:"info"});(function(e,t,n,r){return de()({url:"".concat(ie,"/orders/").concat(e,"/products"),method:"post",data:{productId:t,count:n},headers:{Authorization:"Bearer ".concat(r.token)}})})(h._id,e,n,a).then((function(e){return j(e.data.order)})).then((function(){return p({heading:"Added product to the cart",message:"Check out your cart to see the product",variant:"success"})})).catch((function(e){return p({heading:"Could not add product to the cart",message:"Something went wrong: "+e.message,variant:"danger"})}))},f=function(e){w()||function(e,t,n){return de()({url:"".concat(ie,"/orders/").concat(e,"/products"),method:"delete",data:{productId:t},headers:{Authorization:"Bearer ".concat(n.token)}})}(h._id,e,a).then((function(e){return j(e.data.order)})).then((function(){return p({heading:"Product successfully removed from cart",message:"Better replace it with something else ;)",variant:"success"})})).catch((function(e){return p({heading:"Product not removed from cart",message:"Something went wrong: "+e.message,variant:"danger"})}))},x=function(e,t){w()||function(e,t,n,r){return de()({url:"".concat(ie,"/orders/").concat(e,"/products"),method:"patch",data:{productId:t,count:n},headers:{Authorization:"Bearer ".concat(r.token)}})}(h._id,e,t,a).then((function(e){return j(e.data.order)})).then((function(){return p({heading:"Product count successfully updated",message:"Hope you got more!",variant:"success"})})).catch((function(e){return p({heading:"Product count not updated",message:"Something went wrong: "+e.message,variant:"danger"})}))},w=function(){return!h&&(t.push("/sign-in"),p({heading:"Please sign in",message:"Login or create an account first",variant:"info"}),!0)},v=function(){(function(e){return de()({url:ie+"/orders",method:"post",data:{order:{}},headers:{Authorization:"Bearer ".concat(e.token)}})})(a).then((function(e){return j(e.data.order)})).catch((function(e){return p({heading:"Error loading cart.",message:"Something went wrong: "+e.message,variant:"danger"})}))};return Object(_.jsxs)(C.Fragment,{children:[Object(_.jsx)(re,{user:a}),o.map((function(e){return Object(_.jsx)(R,{heading:e.heading,variant:e.variant,message:e.message,id:e.id,deleteAlert:g},e.id)})),Object(_.jsxs)(bt,{fluid:!0,className:"mb-5",children:[Object(_.jsx)(L.b,{path:"/sign-up",render:function(){return Object(_.jsx)(ye,{msgAlert:p,setUser:m})}}),Object(_.jsx)(L.b,{path:"/sign-in",render:function(){return Object(_.jsx)(Se,{msgAlert:p,setUser:m})}}),Object(_.jsx)(H,{user:a,path:"/sign-out",render:function(){return Object(_.jsx)(ke,{msgAlert:p,clearUser:b,user:a})}}),Object(_.jsx)(H,{user:a,path:"/account",render:function(){return Object(_.jsx)(Be,{msgAlert:p,user:a})}}),Object(_.jsx)(H,{user:a,path:"/cart",render:function(){return Object(_.jsx)(T.Elements,{stripe:mt,children:Object(_.jsx)(rt,{msgAlert:p,user:a,order:h,completeOrder:v,removeFromCart:f,updateProductInCart:x})})}}),Object(_.jsx)(L.b,{path:"/",exact:!0,render:function(){return Object(_.jsx)(ot,{msgAlert:p,user:a,addToCart:O,order:h})}}),Object(_.jsx)(L.b,{path:"/details/:id",exact:!0,render:function(){return Object(_.jsx)(ht,{msgAlert:p,user:a,addToCart:O,order:h})}})]})]})})),pt=Object(_.jsx)(X.a,{basename:"/ecommerce-client",children:Object(_.jsx)(gt,{})});k.a.render(pt,document.getElementById("root"))}},[[133,1,2]]]);
//# sourceMappingURL=main.dbe58183.chunk.js.map